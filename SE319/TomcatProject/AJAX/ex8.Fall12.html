<!-- Brian Reber (breber) -->
<html>
<head>
<title>Ajax Notes</title>

<style>
pre {
	color: red
}

h4 {
	background-color: blue;
	color: white;
}
</style>

<script src="../script/jquery.js" type="text/javascript"></script>
<html>
<body>
	<h3>The book ordering example</h3>

	<input type="button" value="Order"
		onclick="getHtml('../JSP/order.jsp', 'jspholder1')" />
	<input type="button" value="Review Order"
		onclick="sendData('../JSP/response.jsp', 'jspholder1')" />
	<div id="jspholder1"></div>

	<h4>This is a simple book ordering example</h4>

	<input type="button" id="chgH4" value="Change H4 style" />

</body>

<script type="text/javascript">
	$('#chgH4').click(function() {
		$('h4').css('backgroundColor', 'red');
	});

	function getHtml(page, dest) {
		// Just get the page with no arguments
		$.get(page, function(data) {
			$("#" + dest).html(data);
		});
	}

	function sendData(page, dest) {
		// Get each tr element in the table
		var tableRows = $("table tr");
		var postData = {};
		
		// For each element, add the relevant information to the postData
		$.each(tableRows, function(index, row) {
			if (index !== 0) {
				var i = index - 1;
				var checkedCount = $(this).find("#check" + i + ":checked").length;

				// Add the name, author and price for all books
				postData["name" + i] = $("#name" + i).val();
				postData["author" + i] = $("#author" + i).val();
				postData["price" + i] = $("#price" + i).val();
				
				// Only add checked if the item was checked
				if (checkedCount > 0) {
					postData["check" + i] = true;
				}
			}
		});

		// Post to the given page with the data we built
 		$.post(page, postData, function(data) {
			$("#" + dest).html(data);
		});
	}
</script>

</html>
